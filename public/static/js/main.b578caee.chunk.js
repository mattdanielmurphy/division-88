(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(e,t,n){e.exports=n(342)},199:function(e,t,n){},32:function(e,t,n){n(314).config();var a={mode:"production",api:{url:"http://localhost"},redirect:{uri:"http://localhost/api/auth"},app:{url:"http://localhost:3000"}};a.api.url="https://playlist.mattmurphy.ca",a.app.url="https://playlist.mattmurphy.ca",a.redirect.uri="https://playlist.mattmurphy.ca/api/auth",e.exports={env:a}},342:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(46),i=n.n(c),s=(n(199),n(22)),o=n(17),l=n(19),u=n(18),p=n(20),h=n(48),m=n(47),d=n(110),g=n.n(d),f=n(160),y=n.n(f),v=n(352),E=function(){return r.a.createElement(v.a,{secondary:!0,as:"nav"},r.a.createElement(v.a.Item,{id:"logo"},r.a.createElement("svg",{alt:"playlist music by shashank singh from the Noun Project",xmlns:"http://www.w3.org/2000/svg",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 1024 1280"},r.a.createElement("g",null,r.a.createElement("rect",{x:"51.5",y:"200.6",width:"544.4",height:"85"}),r.a.createElement("g",null,r.a.createElement("path",{d:"M595.9,275.7c-18.2,0-36.3,0-54.5,0c-43.2,0-86.5,0-129.7,0c-52.4,0-104.9,0-157.3,0c-45.3,0-90.6,0-136,0    c-15,0-29.9,0-44.9,0c-7,0-14.1-0.5-21.1,0c-0.3,0-0.6,0-1,0c3.3,3.3,6.7,6.7,10,10c0-28.3,0-56.7,0-85c-3.3,3.3-6.7,6.7-10,10    c18.2,0,36.3,0,54.5,0c43.2,0,86.5,0,129.7,0c52.4,0,104.9,0,157.3,0c45.3,0,90.6,0,136,0c15,0,29.9,0,44.9,0c7,0,14.1,0.5,21.1,0    c0.3,0,0.6,0,1,0c-3.3-3.3-6.7-6.7-10-10c0,28.3,0,56.7,0,85c0,12.9,20,12.9,20,0c0-28.3,0-56.7,0-85c0-5.4-4.6-10-10-10    c-18.2,0-36.3,0-54.5,0c-43.2,0-86.5,0-129.7,0c-52.4,0-104.9,0-157.3,0c-45.3,0-90.6,0-136,0c-22,0-44-0.7-66,0c-0.3,0-0.6,0-1,0    c-5.4,0-10,4.6-10,10c0,28.3,0,56.7,0,85c0,5.4,4.6,10,10,10c18.2,0,36.3,0,54.5,0c43.2,0,86.5,0,129.7,0c52.4,0,104.9,0,157.3,0    c45.3,0,90.6,0,136,0c22,0,44,0.7,66,0c0.3,0,0.6,0,1,0C608.8,295.7,608.8,275.7,595.9,275.7z"}))),r.a.createElement("g",null,r.a.createElement("rect",{x:"51.5",y:"398.8",width:"544.4",height:"85"}),r.a.createElement("g",null,r.a.createElement("path",{d:"M595.9,473.8c-18.2,0-36.3,0-54.5,0c-43.2,0-86.5,0-129.7,0c-52.4,0-104.9,0-157.3,0c-45.3,0-90.6,0-136,0    c-15,0-29.9,0-44.9,0c-7,0-14.1-0.5-21.1,0c-0.3,0-0.6,0-1,0c3.3,3.3,6.7,6.7,10,10c0-28.3,0-56.7,0-85c-3.3,3.3-6.7,6.7-10,10    c18.2,0,36.3,0,54.5,0c43.2,0,86.5,0,129.7,0c52.4,0,104.9,0,157.3,0c45.3,0,90.6,0,136,0c15,0,29.9,0,44.9,0c7,0,14.1,0.5,21.1,0    c0.3,0,0.6,0,1,0c-3.3-3.3-6.7-6.7-10-10c0,28.3,0,56.7,0,85c0,12.9,20,12.9,20,0c0-28.3,0-56.7,0-85c0-5.4-4.6-10-10-10    c-18.2,0-36.3,0-54.5,0c-43.2,0-86.5,0-129.7,0c-52.4,0-104.9,0-157.3,0c-45.3,0-90.6,0-136,0c-22,0-44-0.7-66,0c-0.3,0-0.6,0-1,0    c-5.4,0-10,4.6-10,10c0,28.3,0,56.7,0,85c0,5.4,4.6,10,10,10c18.2,0,36.3,0,54.5,0c43.2,0,86.5,0,129.7,0c52.4,0,104.9,0,157.3,0    c45.3,0,90.6,0,136,0c22,0,44,0.7,66,0c0.3,0,0.6,0,1,0C608.8,493.8,608.8,473.8,595.9,473.8z"}))),r.a.createElement("g",null,r.a.createElement("rect",{x:"51.5",y:"597",width:"348.5",height:"85"}),r.a.createElement("g",null,r.a.createElement("path",{d:"M400,672c-11.5,0-23.1,0-34.6,0c-27.7,0-55.4,0-83.1,0c-33.5,0-67.1,0-100.6,0c-29,0-58,0-87.1,0    c-9.6,0-19.2,0-28.8,0c-4.5,0-9.2-0.4-13.7,0c-0.2,0-0.4,0-0.6,0c3.3,3.3,6.7,6.7,10,10c0-28.3,0-56.7,0-85    c-3.3,3.3-6.7,6.7-10,10c11.5,0,23.1,0,34.6,0c27.7,0,55.4,0,83.1,0c33.5,0,67.1,0,100.6,0c29,0,58,0,87.1,0c9.6,0,19.2,0,28.8,0    c4.5,0,9.2,0.4,13.7,0c0.2,0,0.4,0,0.6,0c-3.3-3.3-6.7-6.7-10-10c0,28.3,0,56.7,0,85c0,12.9,20,12.9,20,0c0-28.3,0-56.7,0-85    c0-5.4-4.6-10-10-10c-11.5,0-23.1,0-34.6,0c-27.7,0-55.4,0-83.1,0c-33.5,0-67.1,0-100.6,0c-29,0-58,0-87.1,0    c-14.1,0-28.4-0.6-42.5,0c-0.2,0-0.4,0-0.6,0c-5.4,0-10,4.6-10,10c0,28.3,0,56.7,0,85c0,5.4,4.6,10,10,10c11.5,0,23.1,0,34.6,0    c27.7,0,55.4,0,83.1,0c33.5,0,67.1,0,100.6,0c29,0,58,0,87.1,0c14.1,0,28.4,0.6,42.5,0c0.2,0,0.4,0,0.6,0    C412.9,692,412.9,672,400,672z"}))),r.a.createElement("g",null,r.a.createElement("rect",{x:"723.5",y:"200.6",width:"230.4",height:"85"}),r.a.createElement("g",null,r.a.createElement("path",{d:"M953.9,275.7c-26,0-51.9,0-77.9,0c-41.4,0-82.7,0-124.1,0c-9.5,0-19,0-28.5,0c3.3,3.3,6.7,6.7,10,10    c0-28.3,0-56.7,0-85c-3.3,3.3-6.7,6.7-10,10c26,0,51.9,0,77.9,0c41.4,0,82.7,0,124.1,0c9.5,0,19,0,28.5,0c-3.3-3.3-6.7-6.7-10-10    c0,28.3,0,56.7,0,85c0,12.9,20,12.9,20,0c0-28.3,0-56.7,0-85c0-5.4-4.6-10-10-10c-26,0-51.9,0-77.9,0c-41.4,0-82.7,0-124.1,0    c-9.5,0-19,0-28.5,0c-5.4,0-10,4.6-10,10c0,28.3,0,56.7,0,85c0,5.4,4.6,10,10,10c26,0,51.9,0,77.9,0c41.4,0,82.7,0,124.1,0    c9.5,0,19,0,28.5,0C966.8,295.7,966.8,275.7,953.9,275.7z"}))),r.a.createElement("g",null,r.a.createElement("rect",{x:"723.5",y:"200.6",width:"85",height:"544.4"}),r.a.createElement("g",null,r.a.createElement("path",{d:"M798.5,200.6c0,18.2,0,36.3,0,54.5c0,43.2,0,86.5,0,129.7c0,52.4,0,104.9,0,157.3c0,45.3,0,90.6,0,136    c0,15,0,29.9,0,44.9c0,7-0.5,14.1,0,21.1c0,0.3,0,0.6,0,1c3.3-3.3,6.7-6.7,10-10c-28.3,0-56.7,0-85,0c3.3,3.3,6.7,6.7,10,10    c0-18.2,0-36.3,0-54.5c0-43.2,0-86.5,0-129.7c0-52.4,0-104.9,0-157.3c0-45.3,0-90.6,0-136c0-15,0-29.9,0-44.9c0-7,0.5-14.1,0-21.1    c0-0.3,0-0.6,0-1c-3.3,3.3-6.7,6.7-10,10c28.3,0,56.7,0,85,0c12.9,0,12.9-20,0-20c-28.3,0-56.7,0-85,0c-5.4,0-10,4.6-10,10    c0,18.2,0,36.3,0,54.5c0,43.2,0,86.5,0,129.7c0,52.4,0,104.9,0,157.3c0,45.3,0,90.6,0,136c0,22-0.7,44,0,66c0,0.3,0,0.6,0,1    c0,5.4,4.6,10,10,10c28.3,0,56.7,0,85,0c5.4,0,10-4.6,10-10c0-18.2,0-36.3,0-54.5c0-43.2,0-86.5,0-129.7c0-52.4,0-104.9,0-157.3    c0-45.3,0-90.6,0-136c0-22,0.7-44,0-66c0-0.3,0-0.6,0-1C818.5,187.8,798.5,187.8,798.5,200.6z"}))),r.a.createElement("g",null,r.a.createElement("circle",{cx:"660.3",cy:"745.2",r:"148.3"}),r.a.createElement("g",null,r.a.createElement("path",{d:"M798.5,745.2c-0.3,56.9-36.2,110-90,129.6c-55.3,20.2-117.7,3.2-155.3-42c-37-44.5-41.1-109.8-11.4-159.1    c29.7-49.2,88.8-75.6,145.3-64.2C743.9,621,787.9,667.3,797,724.4C798.1,731.3,798.5,738.3,798.5,745.2c0.1,12.9,20.1,12.9,20,0    c-0.3-66.3-42.4-126.2-104.7-148.9c-61.5-22.5-133.5-2.8-175.1,47.7C496.2,695.5,490,770.1,525,827.4    c34.5,56.6,101.9,85.8,166.8,73c63.4-12.5,114.7-65.7,124.6-129.6c1.3-8.5,2.1-16.9,2.1-25.5C818.6,732.4,798.6,732.3,798.5,745.2    z"}))))),r.a.createElement(v.a.Item,{name:"playlists",as:m.c,exact:!0,activeClassName:"active",to:"/playlists"},"Playlists"),r.a.createElement(v.a.Item,{name:"playlists",as:m.c,exact:!0,activeClassName:"active",to:"/playlists/new"},"New Playlist"))},b=n(15),k=n.n(b),S=n(21),w=n(35),j=n.n(w),x=n(168),O=n(32),P=new function e(){var t=this;Object(o.a)(this,e),this.getDbx=function(){return new x.Dropbox({accessToken:t.accessToken,fetch:j.a})},this.getUser=Object(S.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDbx().usersGetCurrentAccount().then(function(e){return e});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.getSharedLinks=Object(S.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDbx().sharingListSharedLinks().then(function(e){return e.links});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.getLink=function(){var e=Object(S.a)(k.a.mark(function e(n){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDbx().sharingCreateSharedLinkWithSettings({path:n,settings:{requested_visibility:{".tag":"public"}}}).then(function(e){return e.url}).catch(function(e){return console.log("Rejected:",e)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.getSongs=Object(S.a)(k.a.mark(function e(){var n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,t.getDbx().filesListFolder({path:""}).then(function(e){for(var t in e.entries)n.push(e.entries[t])}).catch(function(e){return console.error(e)});case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e)})),this.getAuthorizationUrl=Object(S.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()("".concat(O.env.api.url,"/api/get-auth-url")).then(function(){var e=Object(S.a)(k.a.mark(function e(t){var n,a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,a=n.url,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.authenticate=function(){var e=Object(S.a)(k.a.mark(function e(n){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()("".concat(O.env.api.url,"/api/auth"),{method:"post",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(S.a)(k.a.mark(function e(n){var a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return(a=e.sent)&&(t.accessToken=a),e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},C=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={url:""},n.authUrl=Object(S.a)(k.a.mark(function e(){var t;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getAuthorizationUrl();case 2:t=e.sent,n.setState({url:t});case 4:case"end":return e.stop()}},e)})),n.render=function(){return r.a.createElement("main",null,r.a.createElement("h1",null,"Authorization Required"),n.state.url&&r.a.createElement("a",{href:n.state.url},"Click here to authorize."))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.authUrl()}}]),t}(a.Component),T=function(e){var t=e.playlist;return r.a.createElement("div",null,r.a.createElement(m.b,{to:"/playlists/".concat(t._id),className:"playlist"},t.name))},I=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).render=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"You don't yet have any playlists on this account."),r.a.createElement("p",null,r.a.createElement("a",{href:"/playlists/new"},"Click here to make one!")))},n}return Object(p.a)(t,e),t}(a.Component),L=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={playlists:[]},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(S.a)(k.a.mark(function e(){var t,n,a=this;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getUser();case 2:t=e.sent,n=t.account_id,j()("".concat(O.env.api.url,"/api/").concat(n,"/playlists")).then(function(){var e=Object(S.a)(k.a.mark(function e(t){var n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:0===(n=e.sent).length?a.setState({noPlaylists:!0}):a.setState({playlists:a.state.playlists.concat(n)});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("main",null,r.a.createElement("h1",null,"Playlists"),this.state.noPlaylists?r.a.createElement(I,null):this.state.playlists.map(function(e,t){return r.a.createElement(T,{key:t,playlist:e})}))}}]),t}(a.Component),M=n(169),N=n(68),A=n(170),R=function(){return r.a.createElement("div",{className:"loader"},r.a.createElement("div",null))},_=function(){return r.a.createElement("div",{className:"play-loader-wrapper"},r.a.createElement("div",{className:"play-loader"},r.a.createElement("div",null)))},D=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).render=function(){return r.a.createElement("div",{id:"player-wrapper"},r.a.createElement("div",{id:"player"},r.a.createElement(U,{playing:n.props.playing,togglePlayPause:function(){return n.props.togglePlayPause()},skip:function(e){return n.props.skip(e)},songLoading:n.props.songLoading}),r.a.createElement(W,{timeRemaining:n.props.timeRemaining,disabled:!n.props.canPlayThrough,onChange:function(e){return n.props.handleSeek(e)}})))},n}return Object(p.a)(t,e),t}(a.Component),U=function(e){return r.a.createElement("div",{id:"controls-left"},r.a.createElement(H,{skip:function(){return e.skip("prev")}}),r.a.createElement(F,{playing:e.playing,togglePlayPause:function(){return e.togglePlayPause()},songLoading:e.songLoading}),r.a.createElement(z,{skip:function(){return e.skip("next")}}))},z=function(e){return r.a.createElement("button",{onClick:function(){return e.skip()}},r.a.createElement(N.b,null))},F=function(e){return e.songLoading?r.a.createElement(_,{as:"button"}):r.a.createElement("button",{onClick:function(){return e.togglePlayPause()}},e.playing?r.a.createElement(N.c,null):r.a.createElement(N.d,null))},H=function(e){return r.a.createElement("button",{onClick:function(){return e.skip()}},r.a.createElement(N.a,null))},W=function(e){return r.a.createElement("div",{id:"seek-display"},r.a.createElement("div",{id:"seek-wrapper"},r.a.createElement("input",{type:"range",id:"seek",min:"0",max:"100",defaultValue:"0",disabled:e.disabled,onChange:function(t){return e.onChange(t)}})),r.a.createElement("div",{id:"time-remaining"},"-",e.timeRemaining))},K=(a.Component,D),B=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).render=function(){return r.a.createElement("div",{className:"now-playing"},r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item"})),r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item"})),r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item"})))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=[].slice.call(document.querySelectorAll(".now-playing .item"));console.log(e);var t=function(e){e.forEach(function(e){var t,n,a=(t=0,n=70,Math.random()*(n-t)+t);e.style.top=a+"%"})};setInterval(function(){t(e)},150)}}]),t}(r.a.Component),q=function(e){var t=e.songs,n=e.currentSongIndex,a=e.playing,c=e.playSong;return t&&0!==t.length?r.a.createElement("div",null,t.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"song",onClick:function(){return c(t)}},r.a.createElement("div",{className:"now-playing-container"},a&&n===t?r.a.createElement(B,null):r.a.createElement("div",{className:"song-number"},t+1,".")),r.a.createElement("div",{className:"song-name"},e.name)))})):r.a.createElement("div",null)},J=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={repeat:!1,currentTime:0,timeRemaining:"-:--",songSources:[],canPlayThrough:!1,songLoading:!0},n.startTimeInterval=function(){return n.timeInterval=setInterval(function(){return n.handleTimeUpdate()},1e3)},n.stopTimeInterval=function(){return clearInterval(n.timeInterval)},n.toggleRepeat=function(){return n._isMounted?n.setState({repeat:!n.state.repeat}):null},n.togglePlayPause=function(){return n.state.playing?n.pause():n.play()},n.handleOnPlay=function(){n._isMounted&&n.setState({playing:!0,continuePlaying:!0})},n.handleOnStop=function(){n.stopTimeInterval(),n._isMounted&&n.setState({playing:!1})},n.handleSeek=function(e){return n.state.currentSong.sound.seek(e.target.value)},n.handleKeyDown=function(e){n.keyHeld||(n.keyHeld=!0," "===e.key?n.state.playing?n.pause():n.play():"ArrowRight"===e.key?n.skip("next"):"ArrowLeft"===e.key&&n.skip("prev"))},n.handleKeyUp=function(e){return n.keyHeld=!1},n.componentDidMount=function(){n._isMounted=!0,n.loadAudio(),n.handleKeyboardControls()},n.render=function(){return r.a.createElement("div",null,r.a.createElement(q,{playSong:function(e){return n.playSong(e)},songs:n.props.songs,currentSongIndex:n.props.currentSongIndex,playing:n.state.playing}),r.a.createElement(K,{songLoading:n.state.songLoading,playing:n.state.playing,canPlayThrough:n.state.canPlayThrough,timeRemaining:n.state.timeRemaining,repeat:n.state.repeat,togglePlayPause:function(){return n.togglePlayPause()},skip:function(e){return n.skip(e)},handleSeek:function(e){return n.handleSeek(e)},toggleRepeat:function(e){return n.toggleRepeat(e)}}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"loadAudio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.currentSongIndex,n=this.props.songs,a=n[t];a.sound=new M.Howl({src:a.source,format:"mp3",preload:!0,onload:function(){return e.handleOnLoad()},onend:function(){return e.skip("next")},onplay:function(){return e.handleOnPlay()},onstop:function(){return e.handleOnStop()}}),this.props.setPlaylistState({songs:n}),this._isMounted&&this.setState({currentSong:a})}},{key:"skip",value:function(e){var t="prev"===e?this.props.currentSongIndex-1:this.props.currentSongIndex+1;t<0?t=this.props.songs.length-1:t>this.props.songs.length-1&&(t=0),this.changeSong(t)}},{key:"changeSong",value:function(e){this.state.currentSong.sound.stop(),this._isMounted&&this.setState({songLoading:!0,timeRemaining:"-:--"}),this.props.setPlaylistState({currentSongIndex:e}),this.loadAudio(e),document.getElementById("seek").value=0}},{key:"playSong",value:function(e){this.state.currentSong.sound.stop(),this.props.setPlaylistState({currentSongIndex:e}),this.state.currentSong.sound.play()}},{key:"play",value:function(){this.state.loading?this._isMounted&&this.setState({playWhenReady:!0}):(this.state.currentSong.sound.play(),this._isMounted&&this.setState({continuePlaying:!0}),this.state.playWhenReady&&this.setState({playWhenReady:!1}))}},{key:"pause",value:function(){this._isMounted&&this.setState({playing:!1}),this.state.currentSong.sound.pause()}},{key:"getTimeRemaining",value:function(e){var t,n=e.duration,a=void 0===n?this.state.currentSongDuration:n,r=e.currentTime,c=void 0===r?this.state.currentTime:r,i=Math.floor(a-c),s=i%60;return"".concat(i<60?0:(i-s)/60,":").concat((t=s)<10?"0".concat(t):t)}},{key:"handleOnLoad",value:function(){var e=this.state.currentSong.sound.duration(),t=document.getElementById("seek");if(!t)return null;t.max=e;this.startTimeInterval(),this._isMounted&&this.setState({songLoading:!1,currentSongDuration:e,timeRemaining:this.getTimeRemaining({duration:e,currentTime:0}),canPlayThrough:!0}),this.state.playWhenReady&&!this.state.currentSong.sound.playing()?this.play():this.state.continuePlaying?this.play():this.pause()}},{key:"handleTimeUpdate",value:function(){this._isMounted&&this.setState({currentTime:this.state.currentSong.sound.seek()});var e=document.getElementById("seek");if(!e)return null;e.value=this.state.currentSong.sound.seek(),this._isMounted&&this.setState({timeRemaining:this.getTimeRemaining({currentTime:this.state.currentSong.sound.seek()})})}},{key:"handleKeyboardControls",value:function(){var e=this;window.addEventListener("keydown",function(t){return e.handleKeyDown(t)}),window.addEventListener("keyup",function(t){return e.handleKeyUp(t)})}},{key:"componentWillUnmount",value:function(){var e=this;this._isMounted=!1,this.state.currentSong.sound.off(),this.state.currentSong.sound.unload(),this.stopTimeInterval(),window.removeEventListener("keydown",function(t){return e.handleKeyDown(t)}),window.removeEventListener("keyup",function(t){return e.handleKeyUp(t)})}}]),t}(a.Component),G=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={id:n.props.match.params.id,name:"",songs:[],currentSongIndex:0},n.setCurrentSongIndex=function(e){return n.setState({currentSongIndex:e})},n.setPlaylistState=function(e){return n.setState(e)},n.componentWillMount=function(){return n.getSongs()},n.render=function(){return r.a.createElement("main",null,n.state.error?r.a.createElement("h1",null,n.state.error):n.state.songs&&0!==n.state.songs.length?r.a.createElement("div",{id:"playlist"},r.a.createElement("h1",null,n.state.name),r.a.createElement(J,{currentSongIndex:n.state.currentSongIndex,songs:n.state.songs,setCurrentSongIndex:function(e){return n.setCurrentSongIndex(e)},setPlaylistState:function(e){return n.setPlaylistState(e)}})):r.a.createElement(R,null))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getSongs",value:function(){var e=this;j()("".concat(O.env.api.url,"/api/playlists/").concat(this.state.id)).then(function(){var t=Object(S.a)(k.a.mark(function t(n){var a,r,c,i;return k.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.json();case 2:a=t.sent,r=a.songs,c=a.name,i=a.date,e.setState({songs:Object.values(r),name:c,date:i});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(){return e.setState({error:"Error: Playlist not found!"})})}}]),t}(a.Component),V=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).render=function(){return r.a.createElement("div",{className:"song",onClick:function(e){return n.handleClick(e)}},n.props.name)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"removeSongFromPlaylist",value:function(e){this.props.removeSongFromPlaylist()}},{key:"handleClick",value:function(e){console.log(e.target),e.target.classList.contains("selected")?this.removeSongFromPlaylist(e):this.props.addSongToPlaylist(),e.target.classList.toggle("selected")}}]),t}(a.Component),Y=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={songs:[]},n.render=function(){return r.a.createElement("main",null,r.a.createElement("h2",null,"Songs"),r.a.createElement("div",{id:"songs"},n.state.songs.map(function(e,t){return r.a.createElement(V,{key:t,removeSongFromPlaylist:function(){return n.props.removeSongFromPlaylist(e)},addSongToPlaylist:function(){return n.props.addSongToPlaylist(e)},name:e.name,songObject:e})})))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;P.getSongs().then(function(t){return e.setState({songs:t})})}}]),t}(a.Component),$=n(171),Q=n.n($),X=n(350),Z=n(351),ee=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={playlist:{songs:{}},error:void 0,loading:!1},n.render=function(){return r.a.createElement("main",null,r.a.createElement("h1",null,"Create A Playlist"),r.a.createElement(Y,{dbx:n.props.dbx,addSongToPlaylist:function(e){return n.addSongToPlaylist(e)},removeSongFromPlaylist:function(e){return n.removeSongFromPlaylist(e)}}),r.a.createElement(X.a,{id:"create-playlist",onSubmit:function(e){return n.handleSubmit(e)}},n.state.error&&n.error(),n.state.added&&r.a.createElement("p",null,"Playlist created! Listen to it ",r.a.createElement("a",{href:n.state.link},"here"),"."),r.a.createElement(X.a.Group,null,r.a.createElement(X.a.Input,{type:"text",name:"playlist-name",placeholder:"Playlist Title"}),r.a.createElement(Z.a,{loading:n.state.loading},"Create playlist"))))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"addSongToPlaylist",value:function(e){var t=this.state.playlist;t.songs[e.id]=e,this.setState({playlist:t})}},{key:"removeSongFromPlaylist",value:function(e){var t=this.state.playlist;delete t.songs[e.id],this.setState({playlist:t})}},{key:"getSongLinks",value:function(){var e=Object(S.a)(k.a.mark(function e(t){var n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getSharedLinks();case 2:return n=e.sent,t.forEach(function(){var e=Object(S.a)(k.a.mark(function e(t){var a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=n.find(function(e){return e.id===t.id}))){e.next=5;break}e.t0=a.url,e.next=8;break;case 5:return e.next=7,P.getLink(t.path_lower);case 7:e.t0=e.sent;case 8:t.source=e.t0,t.source=t.source.replace(/\?dl=0/,"").replace(/www.dropbox/,"dl.dropboxusercontent"),t.source+="?raw=1";case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"createPlaylist",value:function(){var e=Object(S.a)(k.a.mark(function e(t,n){var a,r,c,i=this;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.getSongLinks(Object.values(n));case 3:return n=e.sent,a={name:t,songs:n},e.next=7,P.getUser();case 7:r=e.sent,c=r.account_id,j()("".concat(O.env.api.url,"/api/").concat(c,"/playlists"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(S.a)(k.a.mark(function e(t){var n,r;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,r=n._id,console.log("Playlist created",a),i.setState({added:!0,link:"/playlists/".concat(r),loading:!1});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.state.error&&this.setState({error:void 0});case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(S.a)(k.a.mark(function e(t){var n,a,r=this;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=t.target["playlist-name"].value.trim(),a={},Object.keys(this.state.playlist.songs).forEach(function(e){a[e]={},Object.keys(r.state.playlist.songs[e]).forEach(function(t){a[e][Q.a.escape(t)]=r.state.playlist.songs[e][t]})}),0===Object.values(this.state.playlist.songs).length?this.setState({error:"Error: Playlist must contain at least one track."}):n.length<1?this.setState({error:"Error: Playlist must have a name."}):(t.target["playlist-name"].value="",this.createPlaylist(n,a));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"error",value:function(){return r.a.createElement("div",{className:"error"},this.state.error)}}]),t}(a.Component),te=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"404: Page Not Found"),r.a.createElement("p",null,"Sorry about that."))},ne=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).render=function(){return n.props.authenticated?r.a.createElement(h.d,null,r.a.createElement(h.b,{exact:!0,path:"/",render:function(){return r.a.createElement(h.a,{to:"/playlists"})}}),r.a.createElement(h.b,{path:"/auth",render:function(){return n.props.authenticated?r.a.createElement(h.a,{to:"/playlists"}):r.a.createElement(C,null)}}),r.a.createElement(h.b,{exact:!0,path:"/playlists",render:function(e){return r.a.createElement(L,e)}}),r.a.createElement(h.b,{exact:!0,path:"/playlists/new",render:function(e){return r.a.createElement(ee,Object.assign({},n.props,e))}}),r.a.createElement(h.b,{exact:!0,path:"/playlists/:id",render:function(e){return r.a.createElement(G,e)}}),r.a.createElement(h.b,{component:te})):r.a.createElement(h.d,null,r.a.createElement(h.b,{exact:!0,path:"/",component:C}),r.a.createElement(h.b,{exact:!0,path:"/auth",component:C}),r.a.createElement(h.b,{exact:!0,path:"/playlists",component:C}),r.a.createElement(h.b,{exact:!0,path:"/playlists/new",component:C}),r.a.createElement(h.b,{exact:!0,path:"/playlists/:id",render:function(e){return r.a.createElement(G,e)}}),r.a.createElement(h.b,{component:te}))},n}return Object(p.a)(t,e),t}(a.Component),ae=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={loading:!0,authenticated:!1},n.componentDidMount=function(){var e=g.a.get("tokenHash")||y()(window.location.href,!0).query.tokenHash;e?n.authenticate(e):n.setState({loading:!1,authenticated:!1})},n.render=function(){return n.state.loading?r.a.createElement("div",{id:"loading"},"Loading..."):r.a.createElement(m.a,null,r.a.createElement("div",null,r.a.createElement(E,null),r.a.createElement(ne,{authenticated:n.state.authenticated})))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"authenticate",value:function(e){var t=this;console.log("tokenHash:",e),P.authenticate({tokenHash:e}).then(function(n){t.setState({loading:!1,authenticated:n}),n&&g.a.set("tokenHash",e)})}}]),t}(a.Component);n(32).env,Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[194,1,2]]]);
//# sourceMappingURL=main.b578caee.chunk.js.map