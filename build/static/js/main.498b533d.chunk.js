(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{218:function(e,t,n){e.exports=n(392)},223:function(e,t,n){},392:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(39),o=n.n(s),i=(n(223),n(21)),c=n(17),l=n(19),u=n(18),p=n(20),d=n(49),m=n(31),h=n(120),g=n.n(h),f=n(183),y=n.n(f),v=function(){return r.a.createElement("nav",null,r.a.createElement("div",{id:"name"},r.a.createElement("a",{href:"/"},"Playlist Dr")),r.a.createElement("div",{id:"page-links"},r.a.createElement(m.c,{name:"my-playlists",exact:!0,activeClassName:"active",to:"/playlists"},"My Playlists"),r.a.createElement(m.c,{name:"new-playlist",exact:!0,activeClassName:"active",to:"/playlists/new"},"New Playlist")))},b=n(11),E=n.n(b),k=n(22),S=n(33),w=n.n(S),O=n(185),j=n(40),x=new function e(){var t=this;Object(c.a)(this,e),this.getDbx=function(){return new O.Dropbox({accessToken:t.accessToken,fetch:w.a})},this.getUser=Object(k.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDbx().usersGetCurrentAccount().then(function(e){return e});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.getSharedLinks=Object(k.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDbx().sharingListSharedLinks().then(function(e){return e.links});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.getLink=function(){var e=Object(k.a)(E.a.mark(function e(n){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDbx().sharingCreateSharedLinkWithSettings({path:n,settings:{requested_visibility:{".tag":"public"}}}).then(function(e){return e.url}).catch(function(e){return console.log("Rejected:",e)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.getSongs=Object(k.a)(E.a.mark(function e(){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,t.getDbx().filesListFolder({path:""}).then(function(e){for(var t in e.entries)n.push(e.entries[t])}).catch(function(e){return console.error(e)});case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e)})),this.getAuthorizationUrl=Object(k.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w()("".concat(j.env.api.url,"/api/get-auth-url")).then(function(){var e=Object(k.a)(E.a.mark(function e(t){var n,a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,a=n.url,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),this.authenticate=function(){var e=Object(k.a)(E.a.mark(function e(n){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w()("".concat(j.env.api.url,"/api/auth"),{method:"post",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(k.a)(E.a.mark(function e(n){var a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return(a=e.sent)&&(t.accessToken=a),e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},P=function(e){var t=e.type;return r.a.createElement("div",{className:"loader ".concat(t||"")},r.a.createElement("div",null))},C=function(e){var t=e.type;return r.a.createElement("div",{className:"play-loader-wrapper"},r.a.createElement("div",{className:"play-loader ".concat(t||"")},r.a.createElement("div",null)))},N=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={url:""},n.authUrl=Object(k.a)(E.a.mark(function e(){var t;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAuthorizationUrl();case 2:t=e.sent,n.setState({url:t});case 4:case"end":return e.stop()}},e)})),n.render=function(){return r.a.createElement("main",null,r.a.createElement("h1",null,"Authorization Required"),r.a.createElement("div",{id:"content-wrapper"},n.state.url&&r.a.createElement("a",{href:n.state.url},"Click here to authorize.")))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.authUrl()}}]),t}(a.Component),T=n(42),I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],A=function(e){var t=(e=new Date(e)).getFullYear(),n=e.getDate(),a=e.getMonth();return"".concat(I[a]," ").concat(n,", ").concat(t)},L=function(e){var t=e.playlist;return r.a.createElement("div",{className:"playlist"},r.a.createElement(m.b,{to:"/playlists/".concat(t._id)},t.name),r.a.createElement("div",{className:"playlist-date"},A(t.date)))},M=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).render=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"You don't yet have any playlists on this account."),r.a.createElement("p",null,r.a.createElement("a",{href:"/playlists/new"},"Click here to make one!")))},n}return Object(p.a)(t,e),t}(a.Component),R=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={playlists:[],sortReversed:!1},n.loading=!0,n.reverseSort=function(){return n.setState({playlists:n.state.playlists.reverse(),sortReversed:!n.state.sortReversed})},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(E.a.mark(function e(){var t,n,a=this;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getUser();case 2:t=e.sent,n=t.account_id,w()("".concat(j.env.api.url,"/api/").concat(n,"/playlists")).then(function(){var e=Object(k.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,a.loading=!1,0===n.length?a.setState({noPlaylists:!0}):a.setState({playlists:a.state.playlists.concat(n)});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("main",{id:"playlists"},r.a.createElement("div",{className:"top-heading heading no-nav-heading"},r.a.createElement("h1",null,"My Playlists")),r.a.createElement("div",{id:"content-wrapper"},this.loading?r.a.createElement(P,{type:"inline"}):this.state.noPlaylists?r.a.createElement(M,null):r.a.createElement("div",null,r.a.createElement("button",{className:"button date-sort",onClick:function(){return e.reverseSort()}},"Date"," ",r.a.createElement("span",{className:"sort-icon"},this.state.sortReversed?r.a.createElement(T.c,null):r.a.createElement(T.b,null))),this.state.playlists.map(function(e,t){return r.a.createElement(L,{key:t,playlist:e})}))))}}]),t}(a.Component),D=n(186),_=function(e){return r.a.createElement("div",{id:"controls-left"},r.a.createElement(W,{skip:function(){return e.skip("prev")}}),r.a.createElement(U,{playing:e.playing,togglePlayPause:function(){return e.togglePlayPause()},songLoading:e.songLoading}),r.a.createElement(F,{skip:function(){return e.skip("next")}}))},F=function(e){return r.a.createElement("button",{className:"next-song",onClick:function(){return e.skip()}},r.a.createElement(T.d,null))},U=function(e){return e.songLoading?r.a.createElement(C,{as:"button"}):r.a.createElement("button",{className:"play-pause",onClick:function(){return e.togglePlayPause()}},e.playing?r.a.createElement(T.e,null):r.a.createElement(T.f,null))},W=function(e){return r.a.createElement("button",{className:"prev-song",onClick:function(){return e.skip()}},r.a.createElement(T.a,null))},H=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).render=function(){return r.a.createElement("div",{id:"seek-display"},r.a.createElement("div",{id:"seek-wrapper"},r.a.createElement("input",{type:"range",id:"seek",min:"0",max:"100",defaultValue:"0",disabled:n.props.disabled,onChange:function(e){return n.props.onChange(e)}})),r.a.createElement("div",{id:"time-remaining"},"-",n.props.timeRemaining))},n}return Object(p.a)(t,e),t}(a.Component),V=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).curve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5;return Math.pow(e,t)/Math.pow(100,t)*100},n.render=function(){return r.a.createElement("div",{id:"volume-control"},r.a.createElement(T.g,null),r.a.createElement("input",{type:"range",id:"volume-input",min:"0",max:"100",defaultValue:"100",onChange:function(e){return n.onChange(e)}}))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onChange",value:function(e){var t=this.curve(e.target.value)/100;this.props.setVolume(t)}}]),t}(a.Component),B=function(e){return r.a.createElement("div",{id:"controls-right"},r.a.createElement(V,{setVolume:function(t){return e.setVolume(t)}}))},K=function(e){return r.a.createElement("div",{id:"player-wrapper"},r.a.createElement("div",{id:"player"},r.a.createElement(_,{playing:e.playing,togglePlayPause:function(){return e.togglePlayPause()},skip:function(t){return e.skip(t)},songLoading:e.songLoading}),r.a.createElement(H,{timeRemaining:e.timeRemaining,disabled:!e.canPlayThrough,onChange:function(t){return e.handleSeek(t)}}),r.a.createElement(B,{setVolume:function(t){return e.setVolume(t)}})))},J=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).render=function(){return r.a.createElement("div",{className:"now-playing"},r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item"})),r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item"})),r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item"})))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[].slice.call(document.querySelectorAll(".now-playing .item"));this.timer=null;var n=function(e){e.forEach(function(e){var t,n,a=(t=0,n=70,Math.random()*(n-t)+t);e.style.top=a+"%"})};e.timer=setInterval(function(){n(t)},300)}},{key:"componentWillUnmount",value:function(){this.timer=null}}]),t}(r.a.Component),q=function(e){var t=e.songs,n=e.currentSongIndex,a=e.playing,s=e.changeSong,o=e.songLoading;return t&&0!==t.length?t.map(function(e,t){return r.a.createElement("div",{key:t,className:"song ".concat(n===t&&"current-song"),onClick:function(){return s(t)}},r.a.createElement("div",{className:"now-playing-container"},o&&n===t?r.a.createElement(C,{type:"inline"}):a&&n===t?r.a.createElement(J,null):r.a.createElement("div",{className:"song-number"},t+1,".")),r.a.createElement("div",{className:"song-name ".concat(n===t&&a&&"now-playing")},e.name))}):r.a.createElement("div",null)},z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={repeat:!1,currentTime:0,timeRemaining:"-:--",songSources:[],canPlayThrough:!1,songLoading:!0,playing:!1},n.startTimeInterval=function(){return n.timeInterval=setInterval(function(){return n.handleTimeUpdate()},1e3)},n.stopTimeInterval=function(){return clearInterval(n.timeInterval)},n.toggleRepeat=function(){return n._isMounted?n.setState({repeat:!n.state.repeat}):null},n.togglePlayPause=function(){return n.state.playing?n.pause():n.play()},n.handleOnPlay=function(){n._isMounted&&n.setState({playing:!0,continuePlaying:!0})},n.handleOnStop=function(){n.stopTimeInterval(),n._isMounted&&n.setState({playing:!1})},n.handleSeek=function(e){return n.state.currentSong.sound.seek(e.target.value)},n.handleKeyDown=function(e){n.keyHeld||(n.keyHeld=!0," "===e.key?n.state.playing?n.pause():n.play():"ArrowRight"===e.key?n.skip("next"):"ArrowLeft"===e.key&&n.skip("prev"))},n.handleKeyUp=function(e){return n.keyHeld=!1},n.componentDidMount=function(){n._isMounted=!0,n.loadAudio(),n.handleKeyboardControls()},n.render=function(){return r.a.createElement("main",{id:"playlist"},r.a.createElement(q,{changeSong:function(e){return n.changeSong(e)},songs:n.props.songs,currentSongIndex:n.props.currentSongIndex,playing:n.state.playing,songLoading:n.state.songLoading}),r.a.createElement(K,{songLoading:n.state.songLoading,playing:n.state.playing,canPlayThrough:n.state.canPlayThrough,timeRemaining:n.state.timeRemaining,repeat:n.state.repeat,togglePlayPause:function(){return n.togglePlayPause()},skip:function(e){return n.skip(e)},handleSeek:function(e){return n.handleSeek(e)},setVolume:function(e){return n.setVolume(e)},toggleRepeat:function(e){return n.toggleRepeat(e)}}))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"loadAudio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.currentSongIndex,n=this.props.songs,a=n[t];a.sound=new D.Howl({src:a.source,format:"mp3",preload:!0,onload:function(){return e.handleOnLoad()},onend:function(){return e.skip("next")},onplay:function(){return e.handleOnPlay()},onstop:function(){return e.handleOnStop()}}),this.props.setPlaylistState({songs:n}),this._isMounted&&this.setState({currentSong:a})}},{key:"skip",value:function(e){var t="prev"===e?this.props.currentSongIndex-1:this.props.currentSongIndex+1;t<0?t=this.props.songs.length-1:t>this.props.songs.length-1&&(t=0),this.changeSong(t)}},{key:"changeSong",value:function(e){this.state.currentSong.sound.stop(),this._isMounted&&this.setState({songLoading:!0,timeRemaining:"-:--"}),this.props.setPlaylistState({currentSongIndex:e}),this.loadAudio(e),document.getElementById("seek").value=0,this.state.playWhenReady||this.setState({playWhenReady:!0})}},{key:"playSong",value:function(e){this.state.currentSong.sound.stop(),this.props.setPlaylistState({currentSongIndex:e}),this.state.currentSong.sound.play()}},{key:"play",value:function(){this.state.loading?this._isMounted&&this.setState({playWhenReady:!0}):(this.state.currentSong.sound.play(),this._isMounted&&this.setState({continuePlaying:!0}),this.state.playWhenReady&&this.setState({playWhenReady:!1}))}},{key:"pause",value:function(){this._isMounted&&this.setState({playing:!1}),this.state.currentSong.sound.pause()}},{key:"getTimeRemaining",value:function(e){var t,n=e.duration,a=void 0===n?this.state.currentSongDuration:n,r=e.currentTime,s=void 0===r?this.state.currentTime:r,o=Math.floor(a-s),i=o%60;return"".concat(o<60?0:(o-i)/60,":").concat((t=i)<10?"0".concat(t):t)}},{key:"handleOnLoad",value:function(){var e=this.state.currentSong.sound.duration(),t=document.getElementById("seek");if(!t)return null;t.max=e;this.startTimeInterval(),this._isMounted&&this.setState({songLoading:!1,currentSongDuration:e,timeRemaining:this.getTimeRemaining({duration:e,currentTime:0}),canPlayThrough:!0}),this.state.playWhenReady&&!this.state.currentSong.sound.playing()?this.play():this.state.continuePlaying?this.play():this.pause()}},{key:"handleTimeUpdate",value:function(){this._isMounted&&this.setState({currentTime:this.state.currentSong.sound.seek()});var e=document.getElementById("seek");if(!e)return null;e.value=this.state.currentSong.sound.seek(),this._isMounted&&this.setState({timeRemaining:this.getTimeRemaining({currentTime:this.state.currentSong.sound.seek()})})}},{key:"handleKeyboardControls",value:function(){var e=this;window.addEventListener("keydown",function(t){return e.handleKeyDown(t)}),window.addEventListener("keyup",function(t){return e.handleKeyUp(t)})}},{key:"componentWillUnmount",value:function(){var e=this;this._isMounted=!1,this.state.currentSong.sound.off(),this.state.currentSong.sound.unload(),this.stopTimeInterval(),window.removeEventListener("keydown",function(t){return e.handleKeyDown(t)}),window.removeEventListener("keyup",function(t){return e.handleKeyUp(t)})}},{key:"setVolume",value:function(e){this.state.currentSong.sound.volume(e)}}]),t}(a.Component),Y=function(e){return r.a.createElement("div",{className:"back-nav"},r.a.createElement("button",{className:"button",onClick:e.history.goBack},e.text||"Back"))},G=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={id:n.props.match.params.id,name:"",songs:[],currentSongIndex:0},n.setCurrentSongIndex=function(e){return n.setState({currentSongIndex:e})},n.setPlaylistState=function(e){return n.setState(e)},n.componentWillMount=function(){n.getSongs()},n.render=function(){return n.state.error?r.a.createElement("div",{className:"top-heading heading"},r.a.createElement(Y,{history:n.props.history}),r.a.createElement("h1",null,n.state.error)):n.state.songs&&0!==n.state.songs.length?r.a.createElement("div",null,r.a.createElement("div",{className:"top-heading heading"},r.a.createElement("a",{href:"/playlists",className:"button"},"Back to My Playlists"),r.a.createElement("h1",null,n.state.name)),r.a.createElement("div",{id:"content-wrapper"},r.a.createElement(z,{currentSongIndex:n.state.currentSongIndex,songs:n.state.songs,setCurrentSongIndex:function(e){return n.setCurrentSongIndex(e)},setPlaylistState:function(e){return n.setPlaylistState(e)}}))):r.a.createElement(P,null)},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"getSongs",value:function(){var e=this;w()("".concat(j.env.api.url,"/api/playlists/").concat(this.state.id)).then(function(){var t=Object(k.a)(E.a.mark(function t(n){var a,r,s,o;return E.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.json();case 2:a=t.sent,r=a.songs,s=a.name,o=a.date,e.setState({songs:Object.values(r),name:s,date:o});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(){return e.setState({error:"Error: Playlist not found!"})})}}]),t}(a.Component),$=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).render=function(){return r.a.createElement("div",{className:"song ".concat(n.props.selected&&"selected"),onClick:function(){return n.handleClick()}},n.props.name)},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"removeSongFromPlaylist",value:function(e){this.props.removeSongFromPlaylist()}},{key:"handleClick",value:function(e){this.props.selected?this.removeSongFromPlaylist(e):this.props.addSongToPlaylist()}}]),t}(a.Component),Q=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={songs:[]},n.render=function(){return n.state.songs.length<1?r.a.createElement(P,{type:"inline"}):r.a.createElement("div",null,r.a.createElement("div",{className:"heading"},r.a.createElement("h2",{className:"inline"},"Songs"),r.a.createElement(m.b,{to:"/adding-songs"},"(Not sure how to add songs?)")),r.a.createElement("div",{id:"songs"},n.state.songs.map(function(e,t){return r.a.createElement($,{key:t,removeSongFromPlaylist:function(){return n.props.removeSongFromPlaylist(e)},addSongToPlaylist:function(){return n.props.addSongToPlaylist(e)},name:e.name,selected:n.isSongInPlaylist(e)})})))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"isSongInPlaylist",value:function(e){for(var t=!1,n=0;n<this.props.playlistSongs.length;n++){if(this.props.playlistSongs[n].id===e.id){t=!0;break}}return t}},{key:"componentDidMount",value:function(){var e=this;x.getSongs().then(function(t){return e.setState({songs:t})})}}]),t}(a.Component),X=n(208),Z=n(71),ee=function(e){var t=e.song,n=e.index,a=e.handleOnClick;return r.a.createElement(Z.b,{key:t.id,draggableId:t.id,index:n},function(e,s){return r.a.createElement("div",Object.assign({onClick:function(){return a()},ref:e.innerRef},e.draggableProps,e.dragHandleProps,{style:e.draggableProps.style,className:"song playlist-in-progress-song ".concat(s.isDragging&&"being-dragged")}),r.a.createElement("div",{className:"now-playing-container"},r.a.createElement("div",{className:"song-number"},n+1,".")),r.a.createElement("div",{className:"song-name"},t.name))})},te=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).reorderSongs=function(e,t,n){var a=Array.from(e),r=a.splice(t,1),s=Object(X.a)(r,1)[0];return a.splice(n,0,s),a},n.handleOnClick=function(e){return n.props.removeSongFromPlaylist(e)},n.render=function(){return n.props.songs.length<1?null:r.a.createElement("div",null,r.a.createElement("h2",null,"Playlist"),r.a.createElement(Z.a,{onDragEnd:function(e){return n.onDragEnd(e)}},r.a.createElement(Z.c,{droppableId:"droppable"},function(e,t){return r.a.createElement("div",Object.assign({},e.droppableProps,{ref:e.innerRef,className:"playlist-in-progress-container"}),n.props.songs.map(function(e,t){return r.a.createElement(ee,{handleOnClick:function(){return n.handleOnClick(e)},song:e,index:t,key:t})}),e.placeholder)})))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onDragEnd",value:function(e){if(e.destination){var t=this.reorderSongs(this.props.songs,e.source.index,e.destination.index);this.props.updatePlaylistSongs(t)}}}]),t}(a.Component),ne=n(401),ae=n(402),re=n(191),se=n.n(re),oe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={playlist:{songs:[]},error:void 0,loading:!1,songIndex:-1},n.render=function(){return r.a.createElement("main",{id:"create-playlist"},r.a.createElement("div",{className:"top-heading heading no-nav-heading"},r.a.createElement("h2",null,"creating"),r.a.createElement("input",{className:"playlist-title-input",name:"playlist-name",type:"text",placeholder:"Click to set playlist title"})),r.a.createElement("div",{id:"content-wrapper"},r.a.createElement(Q,{dbx:n.props.dbx,addSongToPlaylist:function(e){return n.addSongToPlaylist(e)},removeSongFromPlaylist:function(e){return n.removeSongFromPlaylist(e)},playlistSongs:n.state.playlist.songs}),r.a.createElement(te,{songs:n.state.playlist.songs,addSongToPlaylist:function(e){return n.addSongToPlaylist(e)},removeSongFromPlaylist:function(e){return n.removeSongFromPlaylist(e)},updatePlaylistSongs:function(e){return n.updatePlaylistSongs(e)}}),r.a.createElement(ne.a,{id:"create-playlist",onSubmit:function(e){return n.handleSubmit(e)}},n.state.error&&n.error(),n.state.added&&r.a.createElement(d.a,{to:n.state.link}),r.a.createElement(ae.a,{className:"button large-button",loading:n.state.loading},"Create playlist"))))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"addSongToPlaylist",value:function(e){var t=this.state.playlist;t.songs.push(e),this.setState({playlist:t})}},{key:"removeSongFromPlaylist",value:function(e){var t=this.state.playlist,n=t.songs.findIndex(function(t){return t.id===e.id});t.songs.splice(n,1),this.setState({playlist:t})}},{key:"getSongLinks",value:function(){var e=Object(k.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getSharedLinks();case 2:return n=e.sent,t.forEach(function(){var e=Object(k.a)(E.a.mark(function e(t){var a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=n.find(function(e){return e.id===t.id}))){e.next=5;break}e.t0=a.url,e.next=8;break;case 5:return e.next=7,x.getLink(t.path_lower);case 7:e.t0=e.sent;case 8:t.source=e.t0,t.source=t.source.replace(/\?dl=0/,"").replace(/www.dropbox/,"dl.dropboxusercontent"),t.source+="?raw=1";case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"createPlaylist",value:function(){var e=Object(k.a)(E.a.mark(function e(t,n){var a,r,s,o=this;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.getSongLinks(n);case 3:return n=e.sent,a={name:t,songs:n},e.next=7,x.getUser();case 7:r=e.sent,s=r.account_id,w()("".concat(j.env.api.url,"/api/").concat(s,"/playlists"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(k.a)(E.a.mark(function e(t){var n,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,r=n._id,console.log("Playlist created",a),o.setState({added:!0,link:"/playlists/".concat(r),loading:!1});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.state.error&&this.setState({error:void 0});case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(k.a)(E.a.mark(function e(t){var n,a,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=document.getElementsByName("playlist-name")[0],a=n.value.trim(),r=[],this.state.playlist.songs.forEach(function(e){var t={};Object.keys(e).forEach(function(n){var a=se.a.escape(n);t[a]=e[n]}),r.push(t)}),0===Object.values(this.state.playlist.songs).length?this.setState({error:"Error: Playlist must contain at least one track."}):a.length<1?this.setState({error:"Error: Playlist must have a name (set it at the top)."}):this.createPlaylist(a,r);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"error",value:function(){return r.a.createElement("div",{className:"error"},this.state.error)}},{key:"updatePlaylistSongs",value:function(e){var t=this.state.playlist;t.songs=e,this.setState({playlist:t})}}]),t}(a.Component),ie=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).render=function(){return r.a.createElement("main",null,r.a.createElement("div",{className:"heading top-heading no-nav-heading"},r.a.createElement("h1",null,"Adding Songs")),r.a.createElement("div",{id:"content-wrapper"},r.a.createElement("p",null,"To add songs to Tracksimus, drag them into the ",r.a.createElement("strong",null,"Apps/Tracksimus")," folder inside your Dropbox.")))},n}return Object(p.a)(t,e),t}(a.Component),ce=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"404: Page Not Found"),r.a.createElement("div",{id:"content-wrapper"},r.a.createElement("p",null,"Sorry about that.")))},le=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).render=function(){return n.props.authenticated?r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",render:function(){return r.a.createElement(d.a,{to:"/playlists"})}}),r.a.createElement(d.b,{path:"/auth",render:function(){return n.props.authenticated?r.a.createElement(d.a,{to:"/playlists"}):r.a.createElement(N,null)}}),r.a.createElement(d.b,{exact:!0,path:"/playlists",component:R}),r.a.createElement(d.b,{exact:!0,path:"/playlists/new",render:function(e){return r.a.createElement(oe,Object.assign({},n.props,e))}}),r.a.createElement(d.b,{exact:!0,path:"/playlists/:id",component:G}),r.a.createElement(d.b,{exact:!0,path:"/adding-songs",component:ie}),r.a.createElement(d.b,{component:ce})):r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:N}),r.a.createElement(d.b,{exact:!0,path:"/auth",component:N}),r.a.createElement(d.b,{exact:!0,path:"/playlists",component:N}),r.a.createElement(d.b,{exact:!0,path:"/playlists/new",component:N}),r.a.createElement(d.b,{exact:!0,path:"/playlists/:id",component:G}),r.a.createElement(d.b,{component:ce}))},n}return Object(p.a)(t,e),t}(a.Component),ue=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={loading:!0,authenticated:!1},n.componentDidMount=function(){var e=g.a.get("tokenHash")||y()(window.location.href,!0).query.tokenHash;e?n.authenticate(e):n.setState({loading:!1,authenticated:!1})},n.render=function(){return n.state.loading?r.a.createElement(P,null):r.a.createElement(m.a,null,r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement(le,{authenticated:n.state.authenticated})))},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"authenticate",value:function(e){var t=this;console.log("tokenHash:",e),x.authenticate({tokenHash:e}).then(function(n){t.setState({loading:!1,authenticated:n}),n&&g.a.set("tokenHash",e)})}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},40:function(e,t,n){n(236).config();e.exports={env:{mode:"production",api:{url:"https://playlistdr.com"},redirect:{uri:"https://playlistdr.com/api/auth"},app:{url:"https://playlistdr.com"}}}}},[[218,1,2]]]);
//# sourceMappingURL=main.498b533d.chunk.js.map